<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PrÃ¡ctica Arduino - Sensor Ultrasonido con LCD y OLED</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      overflow-x: hidden;
      height: 100%;
      background: linear-gradient(135deg, #ffecd2, #fcb69f, #ffdde1, #ee9ca7);
      background-size: 400% 400%;
      animation: gradientMove 20s ease infinite;
    }
    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInUp 1s forwards; }
    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    header, footer { z-index: 10; position: relative; }
    main { position: relative; z-index: 10; }
    pre { background-color: rgba(0,0,0,0.85); padding:1rem; border-radius:0.75rem; overflow-x:auto; }
    code { display:block; white-space: pre-wrap; color:#00ff00; }
    button { z-index:20; }
    #toast { display: none; position: fixed; bottom: 2rem; right: 2rem; background-color: #ff6b6b; color: white; padding: 1rem 2rem; border-radius: 1rem; box-shadow: 0 4px 10px rgba(0,0,0,0.3); font-weight: bold; z-index: 50; }
  </style>
</head>
<body>
  <div id="tsparticles" style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:0;"></div>

  <header class="bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 text-white p-10 text-center shadow-xl rounded-b-3xl fade-in">
    <h1 class="text-5xl font-extrabold drop-shadow-xl tracking-wide">PrÃ¡ctica Arduino</h1>
    <p class="text-2xl mt-3 opacity-95">Sensor Ultrasonido con Pantalla LCD y OLED</p>
  </header>

  <main class="max-w-6xl mx-auto p-6 space-y-12 relative">

    <!-- DescripciÃ³n -->
    <section class="bg-white bg-opacity-95 rounded-3xl shadow-2xl p-10 border border-gray-200 hover:shadow-3xl transition transform hover:-translate-y-1 fade-in">
      <h2 class="text-3xl font-bold mb-4 text-pink-600">DescripciÃ³n</h2>
      <p class="leading-relaxed text-lg">Este proyecto utiliza un <strong>Arduino UNO</strong> con un <strong>sensor ultrasÃ³nico HC-SR04</strong> y muestra la distancia medida en una <strong>LCD 16x2 I2C</strong> y una <strong>pantalla OLED</strong>. AdemÃ¡s, se visualiza en el monitor serial.</p>
    </section>

    <!-- Materiales -->
    <section class="bg-white bg-opacity-95 rounded-3xl shadow-2xl p-10 border border-gray-200 hover:shadow-3xl transition transform hover:-translate-y-1 fade-in">
      <h2 class="text-3xl font-bold mb-4 text-pink-600">Materiales</h2>
      <ul class="grid sm:grid-cols-2 gap-y-2 list-disc list-inside text-lg">
        <li>Arduino UNO</li>
        <li>Protoboard</li>
        <li>Pantalla LCD 16x2 con I2C</li>
        <li>Pantalla OLED 128x64</li>
        <li>Sensor de ultrasonidos HC-SR04</li>
        <li>Cables Dupont</li>
      </ul>
    </section>

    <!-- Esquema / Tinkercad -->
    <section class="bg-white bg-opacity-95 rounded-3xl shadow-2xl p-10 border border-gray-200 hover:shadow-3xl transition transform hover:-translate-y-1 fade-in">
      <h2 class="text-3xl font-bold mb-4 text-pink-600">Esquema de conexiÃ³n</h2>
      <p class="mb-4 text-lg">Conexiones recomendadas:</p>
      <ul class="list-disc list-inside mb-6 space-y-2 text-lg">
        <li>HC-SR04: VCC â†’ 5V, GND â†’ GND, Trig â†’ Pin 9, Echo â†’ Pin 10</li>
        <li>Pantalla LCD I2C: VCC â†’ 5V, GND â†’ GND, SDA â†’ A4, SCL â†’ A5</li>
        <li>Pantalla OLED I2C: VCC â†’ 5V, GND â†’ GND, SDA â†’ A4, SCL â†’ A5</li>
      </ul>
      <div class="overflow-hidden rounded-2xl shadow-lg transform hover:scale-[1.02] transition">
        <iframe src="https://www.tinkercad.com/embed/evQV7cH6FR8?editbtn=1" class="w-full h-96 border-0 rounded-xl"></iframe>
      </div>
    </section>

    <!-- CÃ³digo Arduino -->
    <section class="bg-white bg-opacity-95 rounded-3xl shadow-2xl p-10 border border-gray-200 hover:shadow-3xl transition relative transform hover:-translate-y-1 fade-in">
      <h2 class="text-3xl font-bold mb-4 text-pink-600">CÃ³digo Arduino</h2>
      <p class="mb-4 text-lg">Copia y pega este cÃ³digo en el IDE de Arduino:</p>
      <button id="copiar-btn" class="absolute top-8 right-8 bg-gradient-to-r from-pink-500 to-yellow-500 hover:opacity-90 text-white px-5 py-2 rounded-lg shadow-lg transition font-medium">ðŸ“‹ Copiar cÃ³digo</button>
      <pre id="codigo" style="outline:none;"><code>
#include &lt;Wire.h&gt;
#include &lt;Adafruit_GFX.h&gt;
#include &lt;Adafruit_SSD1306.h&gt;
#include &lt;hd44780.h&gt;
#include &lt;hd44780ioClass/hd44780_I2Cexp.h&gt;

// --- ConfiguraciÃ³n OLED ---
#define ANCHO 128
#define ALTO 64
#define RESET -1
Adafruit_SSD1306 display(ANCHO, ALTO, &Wire, RESET);

// --- ConfiguraciÃ³n LCD ---
hd44780_I2Cexp lcd;

// --- Pines del sensor ultrasÃ³nico ---
const int trigPin = 9;
const int echoPin = 10;

// Variables
long duracion;
int distancia;

void setup() {
  Serial.begin(9600);

  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);

  // --- Inicializar OLED ---
  if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) { 
    Serial.println(F("No se encuentra la OLED."));
    for(;;);
  }

  display.clearDisplay();
  display.setTextColor(SSD1306_WHITE);
  display.setTextSize(1);
  display.setCursor(0,0);
  display.println("Sensor Ultrasonico");
  display.display();

  // --- Inicializar LCD 16x2 ---
  int status = lcd.begin(16, 2);
  if (status) { // Si hay error
    Serial.print("LCD error: ");
    Serial.println(status);
    while (1); // Se queda bloqueado
  }

  lcd.backlight();
  lcd.setCursor(0,0);
  lcd.print("Sensor Ultrasonico");

  delay(2000);
}

void loop() {
  // --- MediciÃ³n con el sensor ultrasÃ³nico ---
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  duracion = pulseIn(echoPin, HIGH);

  // Convertir a distancia en cm
  distancia = duracion * 0.034 / 2;

  // Filtrar valores fuera de rango
  if(distancia < 2) distancia = 2;
  if(distancia > 400) distancia = 400;

  // --- Mostrar en monitor serial ---
  Serial.print("Distancia: ");
  Serial.print(distancia);
  Serial.println(" cm");

  // --- Mostrar en OLED ---
  display.clearDisplay();
  display.setTextSize(1);
  display.setCursor(0,0);
  display.println("Distancia:");
  display.setTextSize(2);
  display.setCursor(10,30);
  display.print(distancia);
  display.println(" cm");
  display.display();

  // --- Mostrar en LCD ---
  lcd.clear();
  lcd.setCursor(0,0);
  lcd.print("Distancia:");
  lcd.setCursor(0,1);
  lcd.print(distancia);
  lcd.print(" cm");

  delay(500);
}
        </code></pre><div id="toast">CÃ³digo copiado âœ…</div>
    </section>

  </main>

  <script>
    async function copiarCodigo() {
      const codigo = document.getElementById('codigo').innerText;
      const toast = document.getElementById('toast');
      try {
        await navigator.clipboard.writeText(codigo);
        toast.style.display = 'block';
        setTimeout(() => { toast.style.display = 'none'; }, 1500);
      } catch (err) {
        // Fallback para entornos inseguros
        const textArea = document.createElement('textarea');
        textArea.value = codigo;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try { document.execCommand('copy'); toast.style.display = 'block'; setTimeout(() => { toast.style.display = 'none'; }, 1500); }
        catch { alert('No se pudo copiar el cÃ³digo, selecciona y copia manualmente.'); }
        document.body.removeChild(textArea);
      }
    }

    document.getElementById('copiar-btn').addEventListener('click', copiarCodigo);

    document.addEventListener('DOMContentLoaded', () => {
      if(window.tsParticles){
        tsParticles.load('tsparticles',{background:{color:{value:'transparent'}},fpsLimit:60,particles:{number:{value:200,density:{enable:true,area:1200}},color:{value:['#ff6b6b','#feca57','#ff9ff3','#48dbfb','#1dd1a1']},shape:{type:'circle'},opacity:{value:0.8,random:true},size:{value:{min:2,max:8},random:true},move:{enable:true,speed:3.5,direction:'none',random:true,straight:false,outModes:{default:'out'}}},interactivity:{events:{onHover:{enable:true,mode:'repulse'},onClick:{enable:true,mode:'push'}},modes:{repulse:{distance:180,duration:0.5},push:{quantity:10}}},detectRetina:true});
      } else { console.error('tsParticles no se ha cargado correctamente.'); }
    });
  </script>
</body>
</html>
